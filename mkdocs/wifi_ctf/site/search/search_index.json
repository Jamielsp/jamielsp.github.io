{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Wifi cracking CTF (RedteamRD) El CTF consisti\u00f3 en los siguientes tres retos principales: Important 1. Cu\u00e1les son los dispositivos conectados al 1er Access Point (AP-Guess - est\u00e1 abierto). 2. Conseguir credenciales del File CakeGuest_028ddb17732e. 3. Conseguir credenciales del file Swagger_6cb0ce434217. PCAPS utilizados por si quieren replicar ustedes localmente. Cake pcap Swagger Overview En general me gust\u00f3 mucho aprend\u00ed sobre este mundillo de lo que se conoce hoy como redes inal\u00e1mbricas, algunas terminolog\u00edas que desconoc\u00eda, y gracias al meet previo al CTF pude conocer e interesarme mucho m\u00e1s sobre este tema. En mi mente pensaba que las redes inal\u00e1mbricas hoy en d\u00eda estaban muy seguras, pero me di cuenta que no :) Terminolog\u00eda PMKID es el identificador \u00fanico de la clave utilizado por el AP para hacer un seguimiento de la PMK que se est\u00e1 utilizando para el cliente. PMKID es un derivado de AP MAC, Client MAC, PMK y PMK Name. BSSID (Basic Service Set Identifier), de una red de \u00e1rea local inal\u00e1mbrica (WLAN), es un nombre de identificaci\u00f3n \u00fanico de todos los paquetes de una red inal\u00e1mbrica para identificarlos como parte de esa red. SSID es una secuencia de un m\u00e1ximo de 32 octetos incluida en todos los paquetes de una red inal\u00e1mbrica para identificarlos como parte de esa red. El c\u00f3digo consiste en un m\u00e1ximo de 32 caracteres , que la mayor\u00eda de las veces son alfanum\u00e9ricos (aunque el est\u00e1ndar no lo especifica, as\u00ed que puede consistir en cualquier car\u00e1cter). Todos los dispositivos inal\u00e1mbricos que intentan comunicarse entre s\u00ed deben compartir el mismo SSID. Beacon es uno de los marcos de administraci\u00f3n en redes inal\u00e1mbricas WLAN basadas en IEEE 802.11. Los Beacon frames contienen toda la informaci\u00f3n sobre la red inal\u00e1mbrica y son transmitidos peri\u00f3dicamente para anunciar la presencia de la red WLAN . Airodump-ng se utiliza para la captura de paquetes de tramas 802.11 sin procesar y es especialmente adecuado para recoger los IVs (vector de inicializaci\u00f3n) de WEP con la intenci\u00f3n de utilizarlos con aircrack-ng. Si tienes un receptor GPS conectado al ordenador, airodump-ng es capaz de registrar las coordenadas de los puntos de acceso encontrados. Aircrack-ng es una suite de software de seguridad inal\u00e1mbrica. Consiste en un analizador de paquetes de redes, recupera contrase\u00f1as WEP y WPA/WPA2-PSK y otro conjunto de herramientas de auditor\u00eda inal\u00e1mbrica. Warning Estos son solo uno de los pocos terminos que se escucharon en el meet de todas formas aqu\u00ed les dejo el Meetup, por si tienen el placer de pasarse por all\u00e1, no hay desperdicio :) Ahora si hora del hacking !!!!!!","title":"Home"},{"location":"#wifi-cracking-ctf-redteamrd","text":"El CTF consisti\u00f3 en los siguientes tres retos principales: Important 1. Cu\u00e1les son los dispositivos conectados al 1er Access Point (AP-Guess - est\u00e1 abierto). 2. Conseguir credenciales del File CakeGuest_028ddb17732e. 3. Conseguir credenciales del file Swagger_6cb0ce434217. PCAPS utilizados por si quieren replicar ustedes localmente. Cake pcap Swagger","title":"Wifi cracking CTF (RedteamRD)"},{"location":"#overview","text":"En general me gust\u00f3 mucho aprend\u00ed sobre este mundillo de lo que se conoce hoy como redes inal\u00e1mbricas, algunas terminolog\u00edas que desconoc\u00eda, y gracias al meet previo al CTF pude conocer e interesarme mucho m\u00e1s sobre este tema. En mi mente pensaba que las redes inal\u00e1mbricas hoy en d\u00eda estaban muy seguras, pero me di cuenta que no :)","title":"Overview"},{"location":"#terminologia","text":"PMKID es el identificador \u00fanico de la clave utilizado por el AP para hacer un seguimiento de la PMK que se est\u00e1 utilizando para el cliente. PMKID es un derivado de AP MAC, Client MAC, PMK y PMK Name. BSSID (Basic Service Set Identifier), de una red de \u00e1rea local inal\u00e1mbrica (WLAN), es un nombre de identificaci\u00f3n \u00fanico de todos los paquetes de una red inal\u00e1mbrica para identificarlos como parte de esa red. SSID es una secuencia de un m\u00e1ximo de 32 octetos incluida en todos los paquetes de una red inal\u00e1mbrica para identificarlos como parte de esa red. El c\u00f3digo consiste en un m\u00e1ximo de 32 caracteres , que la mayor\u00eda de las veces son alfanum\u00e9ricos (aunque el est\u00e1ndar no lo especifica, as\u00ed que puede consistir en cualquier car\u00e1cter). Todos los dispositivos inal\u00e1mbricos que intentan comunicarse entre s\u00ed deben compartir el mismo SSID. Beacon es uno de los marcos de administraci\u00f3n en redes inal\u00e1mbricas WLAN basadas en IEEE 802.11. Los Beacon frames contienen toda la informaci\u00f3n sobre la red inal\u00e1mbrica y son transmitidos peri\u00f3dicamente para anunciar la presencia de la red WLAN . Airodump-ng se utiliza para la captura de paquetes de tramas 802.11 sin procesar y es especialmente adecuado para recoger los IVs (vector de inicializaci\u00f3n) de WEP con la intenci\u00f3n de utilizarlos con aircrack-ng. Si tienes un receptor GPS conectado al ordenador, airodump-ng es capaz de registrar las coordenadas de los puntos de acceso encontrados. Aircrack-ng es una suite de software de seguridad inal\u00e1mbrica. Consiste en un analizador de paquetes de redes, recupera contrase\u00f1as WEP y WPA/WPA2-PSK y otro conjunto de herramientas de auditor\u00eda inal\u00e1mbrica. Warning Estos son solo uno de los pocos terminos que se escucharon en el meet de todas formas aqu\u00ed les dejo el Meetup, por si tienen el placer de pasarse por all\u00e1, no hay desperdicio :) Ahora si hora del hacking !!!!!!","title":"Terminolog\u00eda"},{"location":"reto1/","text":"Cu\u00e1les son los dispositivos conectados al 1er Access Point (AP-Guess - est\u00e1 abierto) Esto es relativamente f\u00e1cil de realizar, primero haremos uso de la herramienta airdump-ng para detectar los APS que tenemos en la zona, lo realizaremos por medio de la wlan0 que es la interfaz que configuramos en modo monitor. airodump-ng wlan0 Visto y detectado el objetivo de nosotros que es el AP-GUESS , podremos ver su BSSID , con el cual vamos a realizar el pr\u00f3ximo ataque que nos dar\u00e1 lo que queremos. El BSSID de nuestro AP objetivo fue el siguiente, 02:ED:1F:44:EF:42 , ahora con el siguiente comando, vamos a detectar todos los dispositivos que se encuentran conectados a esa red, solo tenemos que ejecutar lo siguiente. airodump-ng --bssid 02:ED:1F:44:EF:42 --channel 6 --write cap wlan0 Con este comando obtenemos el siguiente resultado: Obteniendo las MACS de todos los dispositivos de esa red, el siguiente paso es identificar los dispositivos, en mi caso las marcas de estos, yo lo obtuve por medio de la siguiente p\u00e1gina. Mac Address an OUI Lookup Info 74:9E:AF:0C:33:F2: Apple, Inc. 50:7A:C5:0C:33:F2: Apple, Inc 44:07:0B:0C:33:F2: Google, Inc C4:93:D9:47:A2:80: Samsung Electronics Co.,Ltd 7C:23:02:82:CE:EB: Samsung Electronics Co.,Ltd F8:95:EA:02:25:16: Apple, Inc Con esto ya hemos completado el reto n\u00famero 1 :)","title":"Reto 1"},{"location":"reto1/#cuales-son-los-dispositivos-conectados-al-1er-access-point-ap-guess-esta-abierto","text":"Esto es relativamente f\u00e1cil de realizar, primero haremos uso de la herramienta airdump-ng para detectar los APS que tenemos en la zona, lo realizaremos por medio de la wlan0 que es la interfaz que configuramos en modo monitor. airodump-ng wlan0 Visto y detectado el objetivo de nosotros que es el AP-GUESS , podremos ver su BSSID , con el cual vamos a realizar el pr\u00f3ximo ataque que nos dar\u00e1 lo que queremos. El BSSID de nuestro AP objetivo fue el siguiente, 02:ED:1F:44:EF:42 , ahora con el siguiente comando, vamos a detectar todos los dispositivos que se encuentran conectados a esa red, solo tenemos que ejecutar lo siguiente. airodump-ng --bssid 02:ED:1F:44:EF:42 --channel 6 --write cap wlan0 Con este comando obtenemos el siguiente resultado: Obteniendo las MACS de todos los dispositivos de esa red, el siguiente paso es identificar los dispositivos, en mi caso las marcas de estos, yo lo obtuve por medio de la siguiente p\u00e1gina. Mac Address an OUI Lookup Info 74:9E:AF:0C:33:F2: Apple, Inc. 50:7A:C5:0C:33:F2: Apple, Inc 44:07:0B:0C:33:F2: Google, Inc C4:93:D9:47:A2:80: Samsung Electronics Co.,Ltd 7C:23:02:82:CE:EB: Samsung Electronics Co.,Ltd F8:95:EA:02:25:16: Apple, Inc Con esto ya hemos completado el reto n\u00famero 1 :)","title":"Cu\u00e1les son los dispositivos conectados al 1er Access Point (AP-Guess - est\u00e1 abierto)"},{"location":"reto2/","text":"Conseguir credenciales del File CakeGuest_028ddb17732e Algo obligatorio en este CTF era hacer uso de hashcat para poder desifrar la password de del WIFI, por lo tanto si tenemos un poco de exp, sabemos que hashcat no trabaja con archivos PCAPS como los que nos proporcionaron, as\u00ed que debemos buscar alg\u00fan m\u00e9todo para convertir este PCAP , en un formato complatible con hashcat. Cambiando formato Con un poco de b\u00fasqueda en internet encontramos una forma, y es que descarg\u00e1ndonos el repositorio de hashcat-utils , podemos hacer uso de un binario que nos permite hacer la conversi\u00f3n que queremos. Nos clonamos el repositorio con el siguiente comando. git clone https://github.com/hashcat/hashcat-utils Descargado el repositorio, accederemos a un dir llamado src , estado ah\u00ed podremos observar un binario llamado cap2hccapx , es el que nos ayudar\u00e1 a cumplir nuestro cometido. Solo tendremos que insertar el siguiente comando estando en el dir donde se encuentra el .bin . ./cap2hccpax.bin [file.pcap] [convertido.hccapx] Veremos que obtuvimos el archivo convertido e incluso nos dice que el file contiene 2 WPA Handshake , muy bien !!! Question Ahora nos viene la pregunta \u00bfQu\u00e9 sigue?, crackear el file obtenido..., correcto !!! Insertando el siguiente comando haciendo uso de hashcat obtendremos nuestro resultado deseado. hashcat -m 2500 [file.hccapx] /usr/share/wordlist/rockyou.txt En el comando vemos que estamos haciendo uso del m\u00f3dulo 2500 de hashcat este m\u00f3dulo su nombre es WPA-EAPOL-PBKDF2 , espec\u00edficamente para crackear este tipo de protocolos de red, luego le pasamos el file que convertimos y por \u00faltimo le pasamos el wordlist que vamos a usar para crackear. Despu\u00e9s de esperar un buen rato (esto va a depender de los recursos de tu PC), obtenemos el resultado. Lo logramos :)","title":"Reto 2"},{"location":"reto2/#conseguir-credenciales-del-file-cakeguest_028ddb17732e","text":"Algo obligatorio en este CTF era hacer uso de hashcat para poder desifrar la password de del WIFI, por lo tanto si tenemos un poco de exp, sabemos que hashcat no trabaja con archivos PCAPS como los que nos proporcionaron, as\u00ed que debemos buscar alg\u00fan m\u00e9todo para convertir este PCAP , en un formato complatible con hashcat.","title":"Conseguir credenciales del File CakeGuest_028ddb17732e"},{"location":"reto2/#cambiando-formato","text":"Con un poco de b\u00fasqueda en internet encontramos una forma, y es que descarg\u00e1ndonos el repositorio de hashcat-utils , podemos hacer uso de un binario que nos permite hacer la conversi\u00f3n que queremos. Nos clonamos el repositorio con el siguiente comando. git clone https://github.com/hashcat/hashcat-utils Descargado el repositorio, accederemos a un dir llamado src , estado ah\u00ed podremos observar un binario llamado cap2hccapx , es el que nos ayudar\u00e1 a cumplir nuestro cometido. Solo tendremos que insertar el siguiente comando estando en el dir donde se encuentra el .bin . ./cap2hccpax.bin [file.pcap] [convertido.hccapx] Veremos que obtuvimos el archivo convertido e incluso nos dice que el file contiene 2 WPA Handshake , muy bien !!! Question Ahora nos viene la pregunta \u00bfQu\u00e9 sigue?, crackear el file obtenido..., correcto !!! Insertando el siguiente comando haciendo uso de hashcat obtendremos nuestro resultado deseado. hashcat -m 2500 [file.hccapx] /usr/share/wordlist/rockyou.txt En el comando vemos que estamos haciendo uso del m\u00f3dulo 2500 de hashcat este m\u00f3dulo su nombre es WPA-EAPOL-PBKDF2 , espec\u00edficamente para crackear este tipo de protocolos de red, luego le pasamos el file que convertimos y por \u00faltimo le pasamos el wordlist que vamos a usar para crackear. Despu\u00e9s de esperar un buen rato (esto va a depender de los recursos de tu PC), obtenemos el resultado. Lo logramos :)","title":"Cambiando formato"},{"location":"reto3/","text":"Conseguir credenciales del file Swagger_6cb0ce434217 Vemos que si intentamos convertir el PCAP de este reto a formato hccapx observaremos que el file no contiene ning\u00fan handshake, ya desde ese punto vas notando que no se puede hacer el m\u00e9todo anterior para conseguir la password. Por lo que vamos a intentar extraer el PMKID, para as\u00ed de esta manera obtener la password, esto lo haremos haciendo uso de la tool llamada hcxpcaptool , esta nos permite extraer PMKID de PCAPS, y guardarlo en un file que debe de tener la extensi\u00f3n .16800 . Por lo tanto el comando se ver\u00eda de la siguiente manera. hcxpcaptool -z nombre_del_file.16800 {ruta del pcap} Vemos que obtuvimos el PMKID de manera efectiva, ahora solo nos queda ponernos hack y obtener la password. Ahora con hashcat en este caso utilizaremos el m\u00f3dulo 16800, que corresponde al m\u00f3dulo de PMKID, por lo tanto nuestro comando estar\u00eda contruido de la siguiente manera. hashcat -m 16800 [file.16800] [wordlist] Lo hemos hecho nuevamente, somos unos cracks !!!!","title":"Reto 3"},{"location":"reto3/#conseguir-credenciales-del-file-swagger_6cb0ce434217","text":"Vemos que si intentamos convertir el PCAP de este reto a formato hccapx observaremos que el file no contiene ning\u00fan handshake, ya desde ese punto vas notando que no se puede hacer el m\u00e9todo anterior para conseguir la password. Por lo que vamos a intentar extraer el PMKID, para as\u00ed de esta manera obtener la password, esto lo haremos haciendo uso de la tool llamada hcxpcaptool , esta nos permite extraer PMKID de PCAPS, y guardarlo en un file que debe de tener la extensi\u00f3n .16800 . Por lo tanto el comando se ver\u00eda de la siguiente manera. hcxpcaptool -z nombre_del_file.16800 {ruta del pcap} Vemos que obtuvimos el PMKID de manera efectiva, ahora solo nos queda ponernos hack y obtener la password. Ahora con hashcat en este caso utilizaremos el m\u00f3dulo 16800, que corresponde al m\u00f3dulo de PMKID, por lo tanto nuestro comando estar\u00eda contruido de la siguiente manera. hashcat -m 16800 [file.16800] [wordlist] Lo hemos hecho nuevamente, somos unos cracks !!!!","title":"Conseguir credenciales del file Swagger_6cb0ce434217"}]}